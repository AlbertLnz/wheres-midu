---
import Layout from '@/layout/Layout.astro'
import Game from '@/components/Game.tsx'
import gameProps from '@/data/gameProps.ts'
import type { Character } from 'src/types'
import { cloudinaryFormDataFnct } from '@/data/cloudinaryFormData.ts'

export function getStaticPaths() {
  return [
    { params: { character: 'Midudev' } },
    { params: { character: 'Altman' } },
    { params: { character: 'PHP' } },
    { params: { character: 'Lady_Gaga' } },
    { params: { character: 'Colby' } },
  ]
}
const { character } = Astro.params

const infoGameProps = gameProps[character as Character]

const cloudinaryApiKey = import.meta.env.CLOUDINARY_API_KEY
const cloudinaryImgsFolder = import.meta.env.PUBLIC_CLOUDINARY_IMGS_FOLDER
const cloudinaryFormData = await cloudinaryFormDataFnct({
  apiKey: cloudinaryApiKey,
  folder: cloudinaryImgsFolder,
})
const formDataObj = Object.fromEntries(cloudinaryFormData.entries())
---

<Layout
  title={`Where's ${character.replace('_', ' ')}`}
  description={`Where's ${character}, juego de donde estÃ¡ ${character}`}
  mainClass=''
>
  <Game client:load character={character as Character} {...infoGameProps} />
</Layout>
